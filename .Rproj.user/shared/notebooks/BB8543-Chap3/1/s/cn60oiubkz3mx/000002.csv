"0","stop.ratio <- c()"
"0","condition <- c()"
"0","meanv <- c()"
"0","nega <- c()"
"0","ind.id  <- c()"
"0","trajectory_xy_max <- c()"
"0","num <- c()"
"0","for (i in 1:n) {"
"0"," subd <- subset(dt, id == as.numeric(uid[i]))"
"0"," num <- i"
"0",""
"0"," condition"
"0"," for (j in 1:length(cond.unique)) {"
"0","   if (length(grep(cond.unique[j], subd$path)) > 0)"
"0","     condition[i] <- cond.unique[j]"
"0","  }"
"0"," "
"0"," # for(i in 1:length(cond.unique)){"
"0"," #   for(j in 1:length(u.ind.id)){"
"0"," #     ind.id <- j"
"0"," #   }"
"0"," # }"
"0",""
"0"," #velovity & stop raio"
"0"," dx <- diff(subd$x.V1)"
"0"," dy <- diff(subd$y.V1)"
"0"," v <- sqrt(dx ^ 2 + dy ^ 2)"
"0"," stop.ratio[i] <- length(which(v < thresh)) / length(v)"
"0"," meanv[i] <- mean(v[v > thresh])*5"
"0",""
"0"," # minmax for trajectory"
"0"," abs_4points_xy <- c(abs(min(subd$x.V1)), abs(min(subd$y.V1)), abs(max(subd$x.V1)), abs(max(subd$y.V1)))"
"0"," trajectory_xy_max[i] <- max(abs_4points_xy)"
"0","}"
